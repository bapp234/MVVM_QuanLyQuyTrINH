<Window x:Class="MVVM_QuanLyQuyTrINH.Views.Windows.SuaCongViec"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Sửa Công Việc" 
        Height="600" Width="550"
        WindowStartupLocation="CenterScreen"
        AllowsTransparency="True" 
        Background="Transparent"
        WindowStyle="None">

    <Border CornerRadius="12" BorderBrush="#3AA0AD" BorderThickness="1" Background="White">
        <Border.Effect>
            <DropShadowEffect BlurRadius="20" Opacity="0.3" ShadowDepth="5"/>
        </Border.Effect>

        <Grid Margin="25">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <!-- Header -->
                <RowDefinition Height="*"/>
                <!-- Form -->
                <RowDefinition Height="Auto"/>
                <!-- Buttons -->
            </Grid.RowDefinitions>

            <!-- HEADER -->
            <TextBlock Text="✏️ Cập Nhật Công Việc" 
                       FontSize="22" FontWeight="Bold" 
                       Foreground="#3AA0AD" 
                       HorizontalAlignment="Center" Margin="0,0,0,20"/>

            <!-- FORM -->
            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="0,0,5,0">

                    <!-- 1. DỰ ÁN (READ ONLY - KHÔNG CHO SỬA) -->
                    <TextBlock Text="Thuộc Dự án (Không thể thay đổi):" FontWeight="SemiBold" Foreground="Gray"/>
                    <TextBox Text="{Binding CongViec.MaDuAnNavigation.TenDuAn}" 
                             Height="35" Margin="0,5,0,15" Padding="5"
                             Background="#F5F5F5" Foreground="Gray" BorderBrush="#DDD"
                             IsReadOnly="True" IsEnabled="False" FontWeight="Bold"/>

                    <!-- 2. TÊN CÔNG VIỆC -->
                    <TextBlock Text="Tên công việc *:" FontWeight="SemiBold" Foreground="#333"/>
                    <TextBox Text="{Binding CongViec.TenCv}" Height="35" Margin="0,5,0,15" Padding="5" BorderBrush="#DDD"/>

                    <!-- 3. MÔ TẢ -->
                    <TextBlock Text="Mô tả chi tiết:" FontWeight="SemiBold" Foreground="#333"/>
                    <TextBox Text="{Binding CongViec.MoTa}" Height="70" Margin="0,5,0,15" Padding="5" 
                             BorderBrush="#DDD" TextWrapping="Wrap" AcceptsReturn="True" VerticalScrollBarVisibility="Auto"/>

                    <!-- 4. NGÀY THÁNG (2 CỘT) -->
                    <Grid Margin="0,0,0,15">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="15"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0">
                            <TextBlock Text="Ngày bắt đầu:" FontWeight="SemiBold" Foreground="#333"/>
                            <DatePicker SelectedDate="{Binding CongViec.NgayGiao}" Height="35" Margin="0,5,0,0"/>
                        </StackPanel>

                        <StackPanel Grid.Column="2">
                            <TextBlock Text="Hạn hoàn thành:" FontWeight="SemiBold" Foreground="#333"/>
                            <DatePicker SelectedDate="{Binding CongViec.HanHoanThanh}" Height="35" Margin="0,5,0,0"/>
                        </StackPanel>
                    </Grid>

                    <!-- 5. TRẠNG THÁI & ĐỘ ƯU TIÊN -->
                    <Grid Margin="0,0,0,15">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="15"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0">
                            <TextBlock Text="Trạng thái:" FontWeight="SemiBold" Foreground="#333"/>
                            <ComboBox SelectedValue="{Binding CongViec.TrangThai}" Height="35" Margin="0,5,0,0" SelectedValuePath="Content">
                                <ComboBoxItem Content="Mới tạo"/>
                                <ComboBoxItem Content="Đang thực hiện"/>
                                <ComboBoxItem Content="Tạm dừng"/>
                                <ComboBoxItem Content="Hoàn thành"/>
                            </ComboBox>
                        </StackPanel>

                        <StackPanel Grid.Column="2">
                            <TextBlock Text="Độ ưu tiên:" FontWeight="SemiBold" Foreground="#333"/>
                            <ComboBox SelectedValue="{Binding CongViec.DoUuTien}" Height="35" Margin="0,5,0,0" SelectedValuePath="Content">
                                <ComboBoxItem Content="Thấp"/>
                                <ComboBoxItem Content="Trung bình"/>
                                <ComboBoxItem Content="Cao"/>
                                <ComboBoxItem Content="Rất cao"/>
                            </ComboBox>
                        </StackPanel>
                    </Grid>

                    <!-- 6. NGƯỜI PHỤ TRÁCH -->
                    <TextBlock Text="Nhân viên phụ trách:" FontWeight="SemiBold" Foreground="#333"/>
                    <ComboBox ItemsSource="{Binding DanhSachNhanVien}"
                              SelectedValue="{Binding CongViec.MaNvphuTrach}"
                              DisplayMemberPath="MaNvNavigation.HoTen"
                              SelectedValuePath="MaNv"
                              Height="35" Margin="0,5,0,15" Padding="5"/>

                </StackPanel>
            </ScrollViewer>

            <!-- FOOTER BUTTONS -->
            <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,20,0,0">
                <Button Content="Hủy bỏ" Width="100" Height="35" Background="#EEE" Foreground="#333" BorderThickness="0" 
                        Click="Close_Click" Margin="0,0,10,0" Cursor="Hand"/>

                <Button Content="💾 Cập Nhật" Width="120" Height="35" Background="#3AA0AD" Foreground="White" FontWeight="Bold" 
                        Click="Save_Click" BorderThickness="0" Cursor="Hand">
                    <Button.Resources>
                        <Style TargetType="Border">
                            <Setter Property="CornerRadius" Value="5"/>
                        </Style>
                    </Button.Resources>
                </Button>
            </StackPanel>
        </Grid>
    </Border>
</Window>